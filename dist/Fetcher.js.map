{"version":3,"file":"Fetcher.js","sourceRoot":"","sources":["../src/Fetcher.ts"],"names":[],"mappings":";;;AAAA,yDAAqD;AAErD,MAAM,QAAQ,GAAG,IAAI,0BAAW,EAAE,CAAC;AAEnC,SAAS,QAAQ,CAAC,MAAc,EAAE,QAAgB;IAC9C,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;WAgCA,MAAM;UACP,QAAQ;CACjB,CAAA;AACD,CAAC;AAED,MAAa,OAAO;IAIhB,YAAY,GAAW,EAAE,QAAgB;QACrC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAA;QACd,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC7B,CAAC;IAEM,KAAK,CAAC,KAAK,CAAC,MAAc;QAC7B,MAAM,QAAQ,GAAG,MAAM,QAAQ,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,EACtE,EAAE,OAAO,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;QAC7B,MAAM,KAAK,GAAG,MAAM,QAAQ,CAAC,OAAO,EAAE,CAAC;QACvC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAA;QAClB,OAAO,KAAK,CAAC;IACjB,CAAC;CACJ;AAhBD,0BAgBC","sourcesContent":["import { QueryEngine } from \"@comunica/query-sparql\";\n\nconst myEngine = new QueryEngine();\n\nfunction getQuery(offset: number, pageSize: number) {\n    return `\nPREFIX prov: <http://www.w3.org/ns/prov#>\nPREFIX foaf: <http://xmlns.com/foaf/0.1/>\nPREFIX skos: <http://www.w3.org/2004/02/skos/core#>\nPREFIX brt: <http://brt.basisregistraties.overheid.nl/def/top10nl#>\nPREFIX bag: <http://bag.basisregistraties.overheid.nl/def/bag#>\nPREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX ex: <http://example.org/>\nPREFIX dcterms: <http://purl.org/dc/terms/>\n\nCONSTRUCT {\n ?version a ex:RoadName ;\n     rdfs:label ?label ;\n    dcterms:isVersionOf ?s ;\n    prov:generatedAtTime ?genAtTime ;\n    <https://data.kkg.kadaster.nl/nen3610/model/def/beginGeldigheid> ?validStarting\n} WHERE {\n  # ?s is a thing in the public domain\n  ?s a <https://data.kkg.kadaster.nl/sor/model/def/OpenbareRuimte> ;\n     # Registered using this version (~ dcterms:hasVersion)\n     <https://data.kkg.kadaster.nl/sor/model/def/geregistreerdMet> ?version ;\n     #?s has a type “road”\n     <https://data.kkg.kadaster.nl/sor/model/def/type> <https://data.kkg.kadaster.nl/nen3610/model/def/Weg> ;\n     skos:prefLabel ?label .\n  \n  ?version \n     # Registered at this timestamp\n     <https://data.kkg.kadaster.nl/nen3610/model/def/tijdstipRegistratie> ?genAtTime ;\n     # But it only starts being the actual state of the streetnames at\n     <https://data.kkg.kadaster.nl/nen3610/model/def/beginGeldigheid> ?validStarting ;\n} ORDER BY ASC(?genAtTime)\n  OFFSET ${offset}\n  LIMIT ${pageSize}\n`\n}\n\nexport class Fetcher {\n    url: string;\n    pageSize: number;\n\n    constructor(url: string, pageSize: number) {\n        this.url = url\n        this.pageSize = pageSize;\n    }\n\n    public async fetch(offset: number) {\n        const response = await myEngine.queryQuads(getQuery(offset, this.pageSize),\n            { sources: [this.url] });\n        const quads = await response.toArray();\n        console.log(quads)\n        return quads;\n    }\n}\n\n"]}